<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>MR Pharma Tools – f1 & f2 Calculator</title>

<style>
body {
  font-family: "Times New Roman", Times, serif;
  max-width: 900px;
  margin: auto;
  padding: 20px;
}
textarea, button {
  font-family: "Times New Roman", Times, serif;
}
textarea {
  width: 100%;
  height: 70px;
}
</style>

<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>

<body>

<h2>Similarity (f₂) & Dissimilarity (f₁) Calculator</h2>

<p><b>Reference Product (% Release)</b></p>
<textarea id="ref">10,25,45,65,85</textarea>

<p><b>Test Product (% Release)</b></p>
<textarea id="test">12,27,43,63,83</textarea>

<button onclick="calc()">Calculate</button>

<p id="result"></p>

<div id="plot"></div>

<script>
function calc() {
  let R = document.getElementById("ref").value.split(",").map(Number);
  let T = document.getElementById("test").value.split(",").map(Number);

  if (R.length !== T.length || R.length < 3) {
    alert("Same number of points required (min 3)");
    return;
  }

  let n = R.length, sumDiff = 0, sumRef = 0, sumSq = 0;

  for (let i = 0; i < n; i++) {
    sumDiff += Math.abs(R[i] - T[i]);
    sumRef += R[i];
    sumSq += Math.pow(R[i] - T[i], 2);
  }

  let f1 = (sumDiff / sumRef) * 100;
  let f2 = 50 * Math.log10(Math.pow(1 + sumSq / n, -0.5) * 100);

  document.getElementById("result").innerHTML =
    "f₁ = " + f1.toFixed(2) +
    "<br>f₂ = " + f2.toFixed(2) +
    "<br><b>" + ((f1 <= 15 && f2 >= 50) ? "SIMILAR" : "NOT SIMILAR") + "</b>";

  Plotly.newPlot("plot", [
    { x: [...Array(n).keys()].map(i => i + 1), y: R, mode: "lines+markers", name: "Reference" },
    { x: [...Array(n).keys()].map(i => i + 1), y: T, mode: "lines+markers", name: "Test" }
  ], {
    title: "% Drug Release vs Time",
    xaxis: { title: "Time Point" },
    yaxis: { title: "% Release" }
  });
}
</script>

</body>
</html>
